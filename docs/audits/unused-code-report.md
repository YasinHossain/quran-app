# Unused Code and Dependencies Report

Generated by running `npx knip` and spot‑checking with `rg` on this codebase. Use this as a working checklist to remove or archive items safely. For each item, verify with a quick search before deletion.

Run again anytime: `npx knip` (or `npm run clean:unused` to auto‑fix where possible).

## Legend

- Status: Candidate = safe to remove after a quick check; Verify = double‑check usage/tests first; Removed = already deleted in this branch.

## High‑Impact Buckets

### 1) IDE history and backups [x]

- [x] `.history/**` — Status: Removed. Local editor backups; safe to keep out of git.

### 2) Legacy Bookmarks UI (superseded by new page) [x]

- [x] `app/(features)/bookmarks/components/BookmarkListView.tsx` — Status: Removed
- [x] `app/(features)/bookmarks/components/BookmarkVerseSidebar.tsx` — Status: Removed
- [x] `app/(features)/bookmarks/components/FolderVerseCard.tsx` — Status: Removed
- [x] `app/(features)/bookmarks/components/header/{HeaderActions,SearchBar,SortDropdown}.tsx` — Status: Removed
- [x] `app/(features)/bookmarks/components/shared/{BookmarkCardComponents,BookmarkListComponents,BookmarksPageHeader}.tsx` — Status: Removed
- [x] Hooks: `app/(features)/bookmarks/hooks/{useBookmarkListState,useVerseListHeight,useBookmarkAudio}.ts` — Status: Removed
- [x] Namespaced subfolders under `components/` (bookmark‑list‑view, bookmark‑verse‑sidebar, bookmarks‑content) — Status: Removed

Rationale: Replaced by `page.tsx` + `BookmarksHeader`, `FolderGrid`, and modular planner flow.

### 3) Old “page reader” feature [x]

- [x] `app/(features)/page/[pageId]/components/*` — Status: Candidate
- [x] `app/(features)/page/[pageId]/hooks/usePageData.ts` — Status: Candidate

Rationale: `PageClient.tsx` delegates to `ReaderShell`; older per‑page list components aren’t referenced.

### 4) Tafsir legacy components (superseded by TafsirViewer)

- [x] `app/(features)/tafsir/[surahId]/[ayahId]/components/{TafsirPanels,TafsirVerse,TranslationSelector,WordTranslationPanel,WordTranslationList,useWordTranslationSearch.ts}` — Status: Candidate
- [x] `app/(features)/tafsir/[surahId]/[ayahId]/hooks/useTafsirPanels.ts` — Status: Candidate

Rationale: Route now composes `TafsirViewer` + `useTafsirVerseData`. Old panel stack not imported by current pages.

### 5) Shared components that appear unused or duplicated

- [x] `app/shared/HeaderSearch.tsx` (old) — Removed; layout now uses `app/shared/components/header/HeaderSearch.tsx`.
- [x] `app/shared/components/AdaptiveLayout.tsx` — Removed along with its private `adaptive-*` helpers.
- [x] `app/shared/components/adaptive-*/*` — Removed (obsolete responsive helpers).
- [x] `app/shared/navigation/{QuickSearch.tsx,QuickSearchModal.tsx}` + `hooks/useQuickSearch.ts` — Removed legacy quick search flow.
- [x] Error boundary wrappers under `app/shared/components/error-boundary/*` — Removed unused feature-specific wrappers/HOCs; core `ErrorBoundary` + default fallback retained.

### 6) Player helpers (likely not used at runtime)

- [ ] `app/shared/player/components/IconBtn.tsx` — Status: Candidate
- [ ] `app/shared/player/utils/{audioSegmentCache.ts,audioSegmentPrefetch.ts,serviceWorkerAudioCache*.ts,playbackOptionSections.tsx}` — Status: Verify (helpers and tests exist; confirm runtime imports before removal).

### 7) Shared UI building blocks that aren’t referenced

- [ ] `app/shared/ui/SettingsPanel.tsx` and `app/shared/ui/settings/*` — Status: Candidate
- [ ] `app/shared/ui/ResourcePanel*.tsx` — Status: Candidate
- [ ] `app/shared/ui/base-card/renderers.tsx` — Status: Candidate

## Other Notable Candidates (from knip)

- [ ] `app/shared/hooks/**`
  - [ ] `useReaderClient.ts`, `useFilteredList.ts`, `useMultiSelection.ts`, etc. — Status: Verify (move to archive or delete if not referenced by app or tests).
- [ ] `app/shared/components/AudioErrorFallback.tsx`, `VerseErrorFallback.tsx` — Status: Candidate

## Unused Dependencies (runtime)

These do not appear in imports anywhere in the app:

- [ ] `ajv`
- [ ] `inversify`
- [ ] `react-icons`
- [ ] `reflect-metadata`

Action: Remove from `dependencies` if DI and JSON‑schema validation are no longer used.

## Unused DevDependencies (knip flagged; verify before removal)

- [ ] Likely removable: `@axe-core/react`, `@rollup/plugin-terser`, `@tailwindcss/postcss`, `@types/humps`, `@umalqura/core`, `chromatic`, `cross-fetch`, `humps`, `next-router-mock`, `node-fetch`, `ts-jest`, `viewport-units-buggyfill`.
- [ ] Likely keep (used indirectly via config or scripts, even if knip complains):
  - [ ] ESLint/Prettier stack: `eslint-config-next`, `eslint-config-prettier`, `eslint-import-resolver-typescript`, `eslint-plugin-jsx-a11y`, `eslint-plugin-prettier`.
  - [ ] Type tooling in scripts: `ts-node`.

## Unlisted/Implicit Deps (informational)

Knip reported Storybook and Jest globals in story/test files. These are OK if Storybook/tests are part of your workflow:

- [ ] `@storybook/react`, `@storybook/test`, `@jest/globals`, `axe-core` (types)

## Suggested Cleanup Order

- [ ] Delete already‑removed legacy bookmark files (done in this branch).
- [ ] Remove old page reader components under `app/(features)/page/[pageId]/components/*`.
- [ ] Remove tafsir legacy components/panels no longer referenced.
- [ ] Remove unused shared UI (SettingsPanel/ResourcePanel) and duplicate header/quick‑search.
- [ ] Trim unused runtime deps (`ajv`, `inversify`, `react-icons`, `reflect-metadata`).
- [ ] Re‑run `npx knip` and repeat.

## Safety Checks After Each Batch

- [ ] `npm run lint`
- [ ] `npm run type-check`
- [ ] `npm run test`
- [ ] `npm run dev` and click through Surah, Tafsir, Bookmarks (planner, recent, pinned, folder views).

## Notes

- Knip’s “unused exports” can be noisy for files only used in stories/tests. Prefer `rg -n "<symbol>"` to confirm real dead code.
- If you want to archive instead of delete, create `legacy/` and add it to ESLint/tsconfig ignore lists.
